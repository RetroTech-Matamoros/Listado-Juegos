<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Instalaci√≥n de Juegos</title>

<style>

/* ========= CRT RETRO ========= */

body{
  background:#0b0b0b;
  color:#00ff99;
  font-family:'Courier New', monospace;
  text-align:center;
}

/* scanlines */
body::after{
  content:"";
  position:fixed;
  width:100%;
  height:100%;
  pointer-events:none;
  background:repeating-linear-gradient(
    to bottom,
    transparent 0px,
    transparent 2px,
    rgba(0,0,0,0.25) 3px
  );
}

.container{
  max-width:900px;
  margin:auto;
  padding:20px;
  box-shadow:0 0 20px #00ff99;
  border-radius:12px;
  animation:fade .25s ease;
}

.logo{
  width:130px;
  margin:0 auto 15px;
  display:block;
}

select,input,button{
  width:100%;
  padding:10px;
  margin:8px 0;
  background:#111;
  color:white;
  border:2px solid #00ff99;
  border-radius:6px;
}

button{
  cursor:pointer;
  font-weight:bold;
}

.smallBtn{
  width:auto;
  padding:6px 12px;
}

.game{
  text-align:left;
  padding:6px;
  border:1px solid #00ff99;
  border-radius:8px;
  margin:4px 0;
}

.progress{
  height:20px;
  background:#333;
  border-radius:10px;
}

.bar{
  height:100%;
  width:0%;
  background:#00ff99;
}

@keyframes fade{
  from{opacity:0}
  to{opacity:1}
}

</style>
</head>

<body>

<!-- ========= SELECTOR ========= -->
<div id="consoleSection" class="container">

  <img src="logo.png" class="logo">

  <h2>üéÆ Selecciona consola</h2>

  <select id="consoleSelect">
    <option value="">Elegir...</option>
    <option>Switch</option>
    <option>GameCube</option>
    <option>PSP</option>
    <option>PS2</option>
    <option>PS3</option>
    <option>Xbox</option>
    <option>Xbox 360</option>
    <option>Wii</option>
    <option>WiiU</option>
    <option>DS</option>
    <option>3DS</option>
  </select>

  <button onclick="start()">Continuar</button>

</div>



<!-- ========= JUEGOS ========= -->
<div id="gamesSection" class="container" style="display:none;">

  <img src="logo.png" class="logo">

  <button class="smallBtn" onclick="volver()">‚Üê Cambiar consola</button>

  <h2 id="titulo"></h2>

  <input id="nombre" placeholder="Nombre del cliente">

  <select id="capacidad">
    <option value="28">32GB (28GB reales)</option>
    <option value="56">64GB (56GB reales)</option>
    <option value="90">128GB (90GB reales)</option>
    <option value="210">256GB (210GB reales)</option>
    <option value="470">512GB (470GB reales)</option>
  </select>

  <input id="buscador" placeholder="Buscar juego...">

  <h3 id="uso">0 / 28 GB</h3>

  <div class="progress"><div class="bar" id="bar"></div></div>

  <div id="lista"></div>

  <button onclick="enviar()">Enviar pedido</button>

</div>



<script>

/* ========= VARIABLES ========= */

let consolaActiva="";
let seleccionados = new Set();

const lista = document.getElementById("lista");
const buscador = document.getElementById("buscador");


/* ========= CAT√ÅLOGO ========= */

const juegos = {

Switch:[
["Zelda BOTW",15],["Mario Kart 8",7],["Smash Bros",14],
["Pokemon Scarlet",8],["Animal Crossing",7],["Metroid Dread",4],
["Splatoon 3",6],["Mario Odyssey",6]
],

GameCube:[
["Wind Waker",1.4],["Mario Sunshine",1.5],["Luigi Mansion",1.2],
["Metroid Prime",1.3],["Resident Evil 4",1.4],["Smash Melee",1.1]
],

PSP:[
["God of War",1.6],["GTA Vice City",1.7],["Monster Hunter",1.3],
["Tekken 6",1.1],["Crisis Core",1.5]
],

PS2:[
["God of War 2",4.2],["GTA San Andreas",4.3],["Shadow of the Colossus",2.1],
["Resident Evil 4",3.5],["Metal Gear 3",3.8]
],

PS3:[
["The Last of Us",38],["Uncharted 3",42],["GTA V",18],
["God of War 3",35],["Red Dead Redemption",8]
],

Xbox:[
["Halo 2",6],["Fable",4],["Ninja Gaiden Black",3]
],

"Xbox 360":[
["Halo Reach",7],["Gears 3",8],["Skyrim",7],["Red Dead",8]
],

Wii:[
["Mario Galaxy",4.3],["Zelda Skyward Sword",4.1],
["Donkey Kong Returns",3.8]
],

WiiU:[
["Mario Kart 8",5.5],["Zelda BOTW",13],["Splatoon",4.8]
],

DS:[
["Pokemon Black",0.25],["Mario Kart DS",0.06],["New Super Mario",0.03]
],

"3DS":[
["Pokemon Ultra Sun",3.6],["Zelda Ocarina 3D",0.6],["Monster Hunter 4U",3.8]
]

};



/* ========= PANTALLAS ========= */

function start(){

  const val = consoleSelect.value;
  if(!val) return alert("Selecciona una consola");

  consolaActiva = val;
  titulo.textContent = "üéÆ " + val;

  consoleSection.style.display="none";
  gamesSection.style.display="block";

  seleccionados.clear();
  render();
  recalcular();
}

function volver(){
  gamesSection.style.display="none";
  consoleSection.style.display="block";
  lista.innerHTML="";
}



/* ========= RENDER ========= */

function render(){

  lista.innerHTML="";

  const filtro = buscador.value.toLowerCase();

  juegos[consolaActiva].forEach(([nombreJuego,size])=>{

    if(!nombreJuego.toLowerCase().includes(filtro)) return;

    const checked = seleccionados.has(nombreJuego) ? "checked" : "";

    lista.innerHTML += `
      <div class="game">
        <label>
          <input type="checkbox" data-name="${nombreJuego}" data-size="${size}" ${checked}>
          ${nombreJuego} (${size} GB)
        </label>
      </div>
    `;
  });

  document.querySelectorAll("#lista input").forEach(cb=>{
    cb.addEventListener("change",()=>{
      if(cb.checked) seleccionados.add(cb.dataset.name);
      else seleccionados.delete(cb.dataset.name);
      recalcular();
    });
  });
}

buscador.addEventListener("input", render);



/* ========= BARRA ========= */

function recalcular(){

  const cap = Number(capacidad.value);
  let total=0;

  juegos[consolaActiva].forEach(([n,s])=>{
    if(seleccionados.has(n)) total+=s;
  });

  uso.textContent = `${total.toFixed(2)} / ${cap} GB`;
  bar.style.width = (total/cap*100)+"%";
}

capacidad.addEventListener("change", recalcular);



/* ========= ENVIAR ========= */

async function enviar(){

  const juegosSel=[...seleccionados];

  let total=0;
  juegos[consolaActiva].forEach(([n,s])=>{
    if(seleccionados.has(n)) total+=s;
  });

  await fetch("https://script.google.com/macros/s/AKfycbzliHQEMx-QuS8B5Yi5r5DbPvT7sJ0fDGl4Ivhm8OjfLBmd2t8e9p7mGxy06BF5ZRQ/exec",{
    method:"POST",
    body:JSON.stringify({
      nombre:nombre.value,
      capacidad:capacidad.value,
      juegos:juegosSel.join(", "),
      espacio:total
    })
  });

  alert("Pedido enviado ‚úÖ");
}

</script>
</body>
</html>

